<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç‘ªå¥‡èˆªç­ç›£æ¸¬ - å…¨ä¸­æ–‡å°ˆæ¥­ç‰ˆ</title>
    <style>
        :root {
            /* ç‘ªå¥‡ç¶“å…¸é…è‰² */
            --mabi-bg: #5ca4ce; --mabi-header: #4b8dc5; --mabi-border: #133c5a;
            --mabi-list-bg: #32648a; --mabi-highlight: #9fe2fb;
            --text-dark: #133c5a; --timer-yellow: #fde047;
            --sidebar-bg: #1a202c; --status-boarding: #10b981; --status-atsea: #3b82f6;

            /* å‹•æ…‹æ¯”ä¾‹ç¸®æ”¾å­—é«” */
            --base-font: clamp(14px, 1.2vw, 22px);
            --title-font: clamp(16px, 1.5vw, 26px);
            --timer-font: clamp(15px, 1.4vw, 24px);
            --detail-font: clamp(16px, 1.6vw, 30px);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: "Microsoft JhengHei", sans-serif; background-color: #0f172a; 
            margin: 0; display: flex; flex-direction: column; height: 100vh;
            color: white; font-size: var(--base-font);
        }

        /* é ‚éƒ¨åˆ°æ¸¯å¿«è¨Š */
        .alerts-container {
            position: sticky; top: 0; z-index: 1000;
            background-color: #1e293b; border-bottom: 3px solid var(--status-boarding);
            padding: 15px 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.6);
        }
        .alert-label { color: var(--status-boarding); font-weight: bold; margin-bottom: 10px; font-size: 1.1em; }
        .grid-tags { display: flex; flex-wrap: wrap; gap: 10px; }
        .tag-boarding { 
            background: var(--status-boarding); color: white; padding: 8px 15px; 
            border-radius: 8px; font-size: 0.9em; font-weight: bold;
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

        /* ä¸»ä½ˆå±€ */
        .main-wrapper { display: flex; flex-grow: 1; overflow: hidden; }

        /* å·¦å´åˆ†é¡å°èˆª */
        .sidebar { 
            width: clamp(180px, 15vw, 300px); background: var(--sidebar-bg); 
            border-right: 3px solid var(--mabi-border); overflow-y: auto; flex-shrink: 0; 
        }
        .sidebar-header { padding: 20px; font-weight: bold; color: var(--mabi-highlight); border-bottom: 1px solid #2d3748; text-align: center; }
        .filter-btn { padding: 18px 20px; cursor: pointer; color: #a0aec0; border-left: 6px solid transparent; transition: 0.2s; }
        .filter-btn:hover { background: rgba(255,255,255,0.05); color: white; }
        .filter-btn.active { 
            background: rgba(74, 144, 226, 0.2); color: var(--mabi-highlight); 
            border-left-color: var(--mabi-header); font-weight: bold; 
        }

        /* å³å´å„€è¡¨æ¿ */
        .dashboard { 
            flex-grow: 1; padding: 25px; overflow-y: auto; background: #111827;
            display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px;
        }

        .mabi-window { background: var(--mabi-bg); border: 3px solid var(--mabi-border); border-radius: 6px; width: 100%; display: flex; flex-direction: column; }
        .mabi-header { background: var(--mabi-header); padding: 10px 15px; font-weight: bold; display: flex; justify-content: space-between; border-bottom: 2px solid var(--mabi-border); }
        .channel-list { margin: 8px; background: var(--mabi-list-bg); border: 2px solid var(--mabi-border); }
        
        .ch-row { padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; }
        .ch-row.boarding { background-color: rgba(16, 185, 129, 0.3); }
        .ch-row.selected { background-color: rgba(255, 255, 255, 0.2); border: 1px solid white; }

        /* é»æ“Šå±•é–‹çš„è³‡è¨Šæ¬„ */
        .detail-row {
            background-color: var(--mabi-highlight); color: var(--text-dark);
            padding: 15px 20px; font-size: var(--detail-font); font-weight: 800;
            display: none; border-bottom: 2px solid var(--mabi-border); line-height: 1.5;
        }
        .ch-row.selected + .detail-row { display: block; }

        .timer-val { color: var(--timer-yellow); font-family: 'Courier New', monospace; font-weight: bold; font-size: var(--timer-font); }
        .status-badge { font-size: 0.75em; padding: 2px 8px; border-radius: 4px; color: white; margin-left: 8px; }
        .bg-boarding { background-color: var(--status-boarding); }
        .bg-atsea { background-color: var(--status-atsea); }

        /* æ‰‹æ©Ÿ RWD */
        @media (max-width: 768px) {
            .main-wrapper { flex-direction: column; }
            .sidebar { width: 100%; height: auto; display: flex; flex-direction: row; border-right: none; border-bottom: 3px solid var(--mabi-border); overflow-x: auto; }
            .sidebar-header { display: none; }
            .filter-btn { padding: 15px; white-space: nowrap; border-left: none; border-bottom: 4px solid transparent; }
            .filter-btn.active { border-bottom-color: var(--mabi-header); }
        }
    </style>
</head>
<body>

<div class="alerts-container">
    <div class="alert-label">âœ… ç›®å‰é–‹æ”¾ç™»èˆ¹çš„åˆ†æµï¼š</div>
    <div class="grid-tags" id="arrivedTags"></div>
</div>

<div class="main-wrapper">
    <div class="sidebar">
        <div class="sidebar-header">èˆªæµ·å€åŸŸå°èˆª</div>
        <div class="filter-btn active" onclick="setFilter('all')">ğŸŒ å…¨éƒ¨èˆªç·š</div>
        <div class="filter-btn" onclick="setFilter('1_å¡æ™®')">âš“ å¡æ™®æ¸¯å£</div>
        <div class="filter-btn" onclick="setFilter('2_è²å³¶')">ğŸ€ è²çˆ¾æ³•æ–¯ç‰¹</div>
        <div class="filter-btn" onclick="setFilter('4_å…‹æ‹‰')">ğŸœï¸ å…‹æ‹‰æ¸¯å£</div>
        <div class="filter-btn" onclick="setFilter('6_å…‹è«¾æ–¯')">ğŸ« å…‹è«¾æ–¯ (æ¯”è·¯é‡Œäº)</div>
        <div class="filter-btn" onclick="setFilter('8_éŒ«æ‹‰')">â„ï¸ éŒ«æ‹‰ (è²è¥¿æ–¯)</div>
        <div class="filter-btn" onclick="setFilter('5_å‡±å®‰')">ğŸ–ï¸ å‡±å®‰æ¸¯å£</div>
    </div>
    <div class="dashboard" id="app"></div>
</div>

<script>
    // æ•´åˆ 3.outputData.html æ•¸æ“šï¼Œä¿®æ­£ atJetty ç‚º 300 ç§’è§£æ±º CH6 é¡¯ç¤ºå•é¡Œ
    const routes = [
        { id: "1_å¡æ™®", name: "1_å¡æ™® â†’ è²å³¶", cycle: 360, atJetty: 300, seeds: ["2026/02/01 21:35:01", "2026/02/01 21:35:04", "2026/02/01 21:34:49", "2026/02/01 21:33:05", "2026/02/01 21:32:57", "2026/02/01 21:35:01", "2026/02/01 21:34:41", "2026/02/01 21:34:49", "2026/02/01 21:34:35", "2026/02/01 21:35:00", "2026/02/01 21:34:41", "2026/02/01 21:38:29", "2026/02/01 21:37:00"] },
        { id: "2_è²å³¶", name: "2_è²å³¶ â†’ å¡æ™®", cycle: 360, atJetty: 300, seeds: ["2026/02/01 21:35:31", "2026/02/01 21:35:34", "2026/02/01 21:35:19", "2026/02/01 21:33:35", "2026/02/01 21:33:27", "2026/02/01 21:35:31", "2026/02/01 21:35:11", "2026/02/01 21:35:19", "2026/02/01 21:35:05", "2026/02/01 21:35:30", "2026/02/01 21:35:11", "2026/02/01 21:38:59", "2026/02/01 21:37:30"] },
        { id: "1_å¡æ™®", name: "3_å¡æ™® â†’ å…‹æ‹‰", cycle: 660, atJetty: 300, seeds: ["2026/02/01 21:44:31", "2026/02/01 21:44:34", "2026/02/01 21:44:20", "2026/02/01 21:42:34", "2026/02/01 21:42:28", "2026/02/01 21:44:30", "2026/02/01 21:44:11", "2026/02/01 21:44:19", "2026/02/01 21:44:05", "2026/02/01 21:44:31", "2026/02/01 21:44:11", "2026/02/01 21:41:58", "2026/02/01 21:41:29"] },
        { id: "4_å…‹æ‹‰", name: "4_å…‹æ‹‰ â†’ å¡æ™®", cycle: 660, atJetty: 300, seeds: ["2026/02/01 21:45:01", "2026/02/01 21:45:04", "2026/02/01 21:44:50", "2026/02/01 21:43:04", "2026/02/01 21:42:58", "2026/02/01 21:45:00", "2026/02/01 21:44:41", "2026/02/01 21:44:49", "2026/02/01 21:44:35", "2026/02/01 21:45:01", "2026/02/01 21:44:41", "2026/02/01 21:42:28", "2026/02/01 21:41:59"] },
        { id: "5_å‡±å®‰", name: "5_å‡±å®‰ â†’ å…‹è«¾æ–¯", cycle: 660, atJetty: 300, seeds: ["2026/02/01 21:45:01", "2026/02/01 21:45:04", "2026/02/01 21:44:49", "2026/02/01 21:43:04", "2026/02/01 21:42:58", "2026/02/01 21:45:01", "2026/02/01 21:44:41", "2026/02/01 21:44:48", "2026/02/01 21:44:35", "2026/02/01 21:45:01", "2026/02/01 21:44:41", "2026/02/01 21:42:29", "2026/02/01 21:42:00"] },
        { id: "6_å…‹è«¾æ–¯", name: "6_å…‹è«¾æ–¯ â†’ å‡±å®‰", cycle: 660, atJetty: 300, seeds: ["2026/02/01 21:45:31", "2026/02/01 21:45:34", "2026/02/01 21:45:19", "2026/02/01 21:43:34", "2026/02/01 21:43:28", "2026/02/01 21:45:31", "2026/02/01 21:45:11", "2026/02/01 21:45:18", "2026/02/01 21:45:05", "2026/02/01 21:45:31", "2026/02/01 21:45:11", "2026/02/01 21:42:59", "2026/02/01 21:42:30"] },
        { id: "5_å‡±å®‰", name: "7_å‡±å®‰ â†’ éŒ«æ‹‰", cycle: 660, atJetty: 300, seeds: ["2026/02/01 21:44:31", "2026/02/01 21:44:34", "2026/02/01 21:44:19", "2026/02/01 21:42:34", "2026/02/01 21:42:27", "2026/02/01 21:44:30", "2026/02/01 21:44:11", "2026/02/01 21:44:18", "2026/02/01 21:44:05", "2026/02/01 21:44:31", "2026/02/01 21:44:12", "2026/02/01 21:52:59", "2026/02/01 21:52:30"] },
        { id: "8_éŒ«æ‹‰", name: "8_éŒ«æ‹‰ â†’ å‡±å®‰", cycle: 660, atJetty: 300, seeds: ["2026/02/01 21:45:31", "2026/02/01 21:45:34", "2026/02/01 21:45:19", "2026/02/01 21:43:34", "2026/02/01 21:43:27", "2026/02/01 21:45:30", "2026/02/01 21:45:11", "2026/02/01 21:45:18", "2026/02/01 21:45:05", "2026/02/01 21:45:31", "2026/02/01 21:45:12", "2026/02/01 21:53:59", "2026/02/01 21:53:30"] }
    ];

    let currentFilter = 'all'; let expanded = null;

    function setFilter(f) {
        currentFilter = f;
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.toggle('active', b.onclick.toString().includes(f)));
        render();
    }

    function toggleDetail(id) { expanded = (expanded === id) ? null : id; render(); }

    function render() {
        const app = document.getElementById('app');
        const arrivedTags = document.getElementById('arrivedTags');
        const now = new Date(); app.innerHTML = ''; arrivedTags.innerHTML = '';

        routes.forEach((route, rIdx) => {
            if (currentFilter !== 'all' && route.id !== currentFilter) return;

            const win = document.createElement('div'); win.className = 'mabi-window';
            let winHtml = `<div class="mabi-header"><span>${route.name}</span><span>X</span></div><div class="channel-list">`;

            route.seeds.forEach((seedStr, cIdx) => {
                const diff = (now.getTime() - new Date(seedStr).getTime()) / 1000;
                const remain = (route.cycle - (diff % route.cycle)) % route.cycle;
                
                // ä¿®æ­£åˆ¤å®šï¼šåªè¦åœ¨ 5 åˆ†é˜å…§éƒ½ç®—é–‹æ”¾ç™»èˆ¹
                const isBoarding = remain <= route.atJetty;
                const timeStr = `${Math.floor(remain/60)}:${Math.floor(remain%60).toString().padStart(2,'0')}`;
                const id = `${rIdx}_${cIdx}`;

                if (isBoarding) {
                    const port = route.name.split(' â†’ ')[0].split('_')[1];
                    arrivedTags.innerHTML += `<div class="tag-boarding">${port} CH${cIdx+1}</div>`;
                }

                winHtml += `
                    <div class="ch-row ${isBoarding ? 'boarding' : ''} ${expanded === id ? 'selected' : ''}" onclick="toggleDetail('${id}')">
                        <span>CHANNEL ${cIdx+1} <span class="status-badge ${isBoarding ? 'bg-boarding' : 'bg-atsea'}">${isBoarding ? 'é–‹æ”¾ç™»èˆ¹' : 'æœªåˆ°æ¸¯'}</span></span>
                        <span class="timer-val">${timeStr}</span>
                    </div>
                    <div class="detail-row">
                        ğŸš¢ ä¸‹ç­å‡ºç™¼å‰©é¤˜ï¼š<span style="color:#d946ef">${timeStr}</span><br>
                        ğŸ“Š ç•¶å‰ç‹€æ…‹ï¼š${isBoarding ? 'ğŸŸ¢ é–‹æ”¾ç™»èˆ¹ä¸­' : 'ğŸ”µ å°šæœªåˆ°æ¸¯'}
                    </div>`;
            });
            win.innerHTML = winHtml + '</div>'; app.appendChild(win);
        });
        if (!arrivedTags.innerHTML) arrivedTags.innerHTML = '<span style="color:#64748b; font-size:0.8em;">(ç›®å‰æš«ç„¡é–‹æ”¾ç™»èˆ¹çš„åˆ†æµ)</span>';
    }

    setInterval(render, 1000); render();
</script>

</body>
</html>